# Zig e2e hook contract for tools/e2e_runner.zig.

repo_root := '../../..'
zig_build := 'cache_dir="${E2E_ZIG_GLOBAL_CACHE_DIR:-./.zig-global-cache}"; E2E_ZIG_GLOBAL_CACHE_DIR="$cache_dir" ZIG_GLOBAL_CACHE_DIR="$cache_dir" zig build'

build-client:
    cd {{repo_root}} && {{zig_build}} e2e-zig-client -- --help >/dev/null

build-server:
    cd {{repo_root}} && {{zig_build}} e2e-zig-server -- --help >/dev/null

client-hook host port schema backend="unknown":
    cd {{repo_root}} && E2E_BACKEND={{backend}} {{zig_build}} e2e-zig-client -- --host {{host}} --port {{port}} --schema {{schema}}

server-hook host port schema:
    cd {{repo_root}} && {{zig_build}} e2e-zig-server -- --host {{host}} --port {{port}} --schema {{schema}}
